import{h}from"./swiper.CRHIZDQr.js";function V({swiper:e,extendParams:B,on:u,emit:l,params:d}){e.autoplay={running:!1,paused:!1,timeLeft:0},B({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let f,v,T=d&&d.autoplay?d.autoplay.delay:3e3,E=d&&d.autoplay?d.autoplay.delay:3e3,n,c=new Date().getTime(),b,p,s,M,r,D;function O(t){!e||e.destroyed||!e.wrapperEl||t.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",O),!(D||t.detail&&t.detail.bySwiperTouchMove)&&i())}const A=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?b=!0:b&&(E=n,b=!1);const t=e.autoplay.paused?n:c+E-new Date().getTime();e.autoplay.timeLeft=t,l("autoplayTimeLeft",t,t/T),v=requestAnimationFrame(()=>{A()})},q=()=>{let t;return e.virtual&&e.params.virtual.enabled?t=e.slides.find(o=>o.classList.contains("swiper-slide-active")):t=e.slides[e.activeIndex],t?parseInt(t.getAttribute("data-swiper-autoplay"),10):void 0},L=()=>{let t=e.params.autoplay.delay;const a=q();return!Number.isNaN(a)&&a>0&&(t=a),t},g=t=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(v),A();let a=t;typeof a>"u"&&(a=L(),T=a,E=a),n=a;const o=e.params.speed,S=()=>{!e||e.destroyed||(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(o,!0,!0),l("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,o,!0,!0),l("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(o,!0,!0),l("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,o,!0,!0),l("autoplay")),e.params.cssMode&&(c=new Date().getTime(),requestAnimationFrame(()=>{g()})))};return a>0?(clearTimeout(f),f=setTimeout(()=>{S()},a)):requestAnimationFrame(()=>{S()}),a},F=()=>{c=new Date().getTime(),e.autoplay.running=!0,g(),l("autoplayStart")},m=()=>{e.autoplay.running=!1,clearTimeout(f),cancelAnimationFrame(v),l("autoplayStop")},y=(t,a)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(f),t||(r=!0);const o=()=>{l("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",O):i()};if(e.autoplay.paused=!0,a){o();return}n=(n||e.params.autoplay.delay)-(new Date().getTime()-c),!(e.isEnd&&n<0&&!e.params.loop)&&(n<0&&(n=0),o())},i=()=>{e.isEnd&&n<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(c=new Date().getTime(),r?(r=!1,g(n)):g(),e.autoplay.paused=!1,l("autoplayResume"))},I=()=>{if(e.destroyed||!e.autoplay.running)return;const t=h();t.visibilityState==="hidden"&&(r=!0,y(!0)),t.visibilityState==="visible"&&i()},P=t=>{t.pointerType==="mouse"&&(r=!0,D=!0,!(e.animating||e.autoplay.paused)&&y(!0))},N=t=>{t.pointerType==="mouse"&&(D=!1,e.autoplay.paused&&i())},x=()=>{e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",P),e.el.addEventListener("pointerleave",N))},C=()=>{e.el&&typeof e.el!="string"&&(e.el.removeEventListener("pointerenter",P),e.el.removeEventListener("pointerleave",N))},R=()=>{h().addEventListener("visibilitychange",I)},_=()=>{h().removeEventListener("visibilitychange",I)};u("init",()=>{e.params.autoplay.enabled&&(x(),R(),F())}),u("destroy",()=>{C(),_(),e.autoplay.running&&m()}),u("_freeModeStaticRelease",()=>{(s||r)&&i()}),u("_freeModeNoMomentumRelease",()=>{e.params.autoplay.disableOnInteraction?m():y(!0,!0)}),u("beforeTransitionStart",(t,a,o)=>{e.destroyed||!e.autoplay.running||(o||!e.params.autoplay.disableOnInteraction?y(!0,!0):m())}),u("sliderFirstMove",()=>{if(!(e.destroyed||!e.autoplay.running)){if(e.params.autoplay.disableOnInteraction){m();return}p=!0,s=!1,r=!1,M=setTimeout(()=>{r=!0,s=!0,y(!0)},200)}}),u("touchEnd",()=>{if(!(e.destroyed||!e.autoplay.running||!p)){if(clearTimeout(M),clearTimeout(f),e.params.autoplay.disableOnInteraction){s=!1,p=!1;return}s&&e.params.cssMode&&i(),s=!1,p=!1}}),u("slideChange",()=>{e.destroyed||!e.autoplay.running||e.autoplay.paused&&(n=L(),T=L())}),Object.assign(e.autoplay,{start:F,stop:m,pause:y,resume:i})}export{V as A};
